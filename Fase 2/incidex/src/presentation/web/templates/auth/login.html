{% extends "_layouts/base_public.html" %}
{% set title = "Login" %}
{% block content %}

<section class="auth">
  <div class="auth__card">

    <aside class="auth__aside">
      <img class="auth__logo" src="{{ url_for('static', filename='img/logo_incidex.png') }}" alt="Incidex">
      <h1 class="auth__title">Bienvenido</h1>
      <p class="auth__subtitle">Inicia sesión para administrar tus incidencias.</p>

      <ul class="auth__bullets">
        <li>Clasificación con IA</li>
        <li>Seguimiento claro y rápido</li>
        <li>Reportes exportables (CSV)</li>
      </ul>
    </aside>

    <div class="auth__form">
      {# toasts globales #}
      {% include "_partials/flash_toasts.jinja" %}

      <form action="{{ url_for('auth.login') }}" method="post" novalidate class="form">

        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

        <div class="form__group">
          <label for="email">Correo</label>
          <input
            id="email"
            name="email"
            type="email"
            class="form__control"
            placeholder="tu@empresa.com"
            autocomplete="email"
            required>
        </div>

        <div class="form__group">
          <label for="password">Contraseña</label>
          <div class="form__control--with-addon">
            <input
              id="password"
              name="password"
              type="password"
              class="form__control"
              placeholder="••••••••"
              autocomplete="current-password"
              minlength="6"
              required>
            <button type="button" class="pass-toggle" aria-label="Mostrar u ocultar contraseña">
              <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                <path d="M12 5c5 0 9 3.5 10.5 7-1.5 3.5-5.5 7-10.5 7S3 15.5 1.5 12C3 8.5 7 5 12 5zm0 3a4 4 0 1 0 0 8 4 4 0 0 0 0-8z"></path>
              </svg>
            </button>
          </div>
        </div>

        <div class="form__row">
          <label class="check">
            <input type="checkbox" name="remember">
            <span>Recordarme</span>
          </label>
          <a href="{{ url_for('public.support') }}" class="link">¿Olvidaste tu contraseña?</a>
        </div>

        <button class="btn btn-primary btn--full" type="submit">Iniciar sesión</button>

        <p class="form__meta">
          ¿Sin acceso? <a class="link" href="{{ url_for('public.support') }}">Contactar soporte</a>
        </p>
      </form>
    </div>
  </div>
</section>

<script>
  // Mostrar o ocultar contraseña (luego cambiar esto)
  (function () {
    const toggle = document.querySelector('.pass-toggle');
    const input = document.getElementById('password');
    if (toggle && input) {
      toggle.addEventListener('click', () => {
        input.type = input.type === 'password' ? 'text' : 'password';
      });
    }
  })();
</script>

{% endblock %}
